# 8 병합과 충돌

## 8.1 병합
분리된 브랜치를 하나로 합치는 것

### 8.1.3 병합방식

- Fast-Forward 병합
- 3-way 병합

깃은 각 브랜치를 비교하여 자동병합함.

## 8.2 Fast-Forward 병합

순차적으로 코드가 수정될 때 순차적 커밋에 맞추어 병합하는것

다른 브랜치가 있다하더라도, 로그를 보았을 때
일직선상으로 1개만 있는 경우 이를 병합할때 Fast-Forward 방식의 병합을 하게됨

### 8.2.2 병합위치
`merge`명령어를 통해 병합 가능
merge명령어는 현재 HEAD가 가리키고 있는 브랜치를 기준으로 
다른 브랜치의 모든 커밋을 병합함.

### 8.2.3 Fast-Forward 병합 적용

```sh
// 현재위치 master
$ git merge feature
Updating f23d5c...
Fast-forward
```

Fast-Forward에 한해 작업한 브랜치의 시작 커밋을
원본 브랜치 이후의 커밋으로 가리킴
이는 단순히 커밋 위치를 최신으로 옮기는것과 비슷함

병합할 하나의 브랜치 파일을 기준브랜치로 복사하여 수정된 파일을 원본에 그대로 적용한것과 같음.
원본에 추가된 내용이 없다는 가정하에 변경한 파일을 대체하는것

## 8.3 3-way 병합

기준 커밋에서 서로 다른 브랜치의 커밋이 연결되는 Y자모양을 병합

### 8.3.3 공통조상

브랜치의 모양이 갈라지는 형태로 나뉠때는 Fast-Forward방식의 알고리즘은 사용할 수 없어 3-way방식을 사용함
두 브랜치의 분할 기준인 공통커밋을 찾아야하고, 이를 공통 조상커밋이라고 함.
공통조상커밋을 포함하는 브랜치, 새로운 2 브랜치를 포함해 3개를 하나로 병합하므로 3-way병합이라 함

### 8.3.4 병합커밋
3-way 병합은 두 브랜치의 공통 조상커밋을 자동으로 찾은 후 공통조상커밋을 기준으로 브랜치를 병합한다. 병합을 성공적으로 완료한 후에는 새로운 커밋을 하나로 생성한다.
새로 생성된 커밋을 병합커밋이라고 하며, 병합커밋은 부모커밋이 2개라는 특징이 있다.

### 8.3.5 병합 메시지
깃은 3-way방법으로 병합 후 새로운 커밋을 하면서 동시에 
메시지("Merge branch '브랜치명'")를 생성함

자동 저장되는 메시지 외에 직접 커밋메시지를 작성하기 위해서는
```sh
$ git merge 브랜치이름 --edit
```

## 8.4 브랜치 삭제

> 깃플로  
브랜치 작업 규격화. master, feature, develop, release, hotfix를 브랜치명으로 사용  
develop브랜치는 병합후에도 삭제하지 않고 사용(long-running)

`git branch -d 브랜치명` 명령어를 통해 브랜치를 삭제할 수 있다  
단, 병합이 완료된 브랜치만 -d옵션으로 삭제할 수 있고  
병합되지 않은 브랜치는 -D옵션을 통해 삭제 할 수 있다.

## 8.5 충돌

충돌원인 : 같은 위치의 코드를 동시에 수정할 경우 발생  

충돌이 발생할 경우 자동으로 병합되지도, 커밋되지도 않고 'Merge Conflicts' 메시지를 출력한다.  

> 병합 취소  
`git merge --abort`명령어로 병합을 취소할 수 있다.

### 8.5.3 수동으로 충돌 해결

충돌 발생 시 충돌코드와 내용을 기호와 함께 표시함

<pre>
<<<<< HEAD (current)
기준이 되는 브랜치의 내용

======

병합하고자하는 브랜치의 내용
>>>>> 브랜치이름 (incomming)

</pre>
current : 현재 브랜치

incomming : 합치고자 하는 브랜치

충돌 시 자동으로 커밋이 생성되지 않으므로 수정 후 커밋을 해주어야 병합이 완료된다.

## 8.6 브랜치 병합 여부 확인

병합완료 후 혼동을 줄이기 위해 브랜치를 삭제하는것이 좋다.

병합한 브랜치와 하지 않은 브랜치를 구분하는 옵션

`git branch --merged`
  feature  
  footer  
\* master  
병합한 브랜치는 \*기호로 표시된다. 병합완료된 경우 -d 옵션을 통해 삭제가능

`git branch --no-merged`

병합되지 않은 브랜치는 -d옵션으로 삭제할 수 없으므로 -D옵션을 사용한다


## 8.7 리베이스

